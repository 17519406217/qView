parameters:
- name: version
  type: string
  default: '5.12.8'

- name: arch
  type: string
${{ if eq(variables['Agent.OS'], 'Windows_NT') }}:
  default: 'win64_msvc2017_64'

- name: os
  type: string
${{ if eq( variables['Agent.OS'], 'Windows_NT' ) }}:
  default: windows
${{ if eq( variables['Agent.OS'], 'Darwin' ) }}:
  default: mac
${{ if eq( variables['Agent.OS'], 'Linux' ) }}:
  default: linux

steps:
- script: |
    sudo apt-get update
    sudo apt-get install libgl1-mesa-dev libxkbcommon-x11-0 libgtk2.0-dev -y
  condition: eq( variables['Agent.OS'], 'Linux' )
  displayName: 'Install packages for Qt'

- task: UsePythonVersion@0
  inputs:
    versionSpec: '3.8'
  displayName: 'Use Python 3.8'

- bash: |
    pip install "aqtinstall==0.8"
    python -m aqt install ${{ parameters.version }} ${{ parameters.os }} desktop ${{ parameters.arch }}
    cd ${{ version }}/*/bin
    echo ##vso[task.prependpath]$PWD
  displayName: 'Install Qt'
